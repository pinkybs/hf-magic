/*!
 * lhgcore Dialog Plugin v3.3.0
 * Date : 2011-03-30 10:05:11
 * Copyright (c) 2009 - 2011 By Li Hui Gang
 */
(function(a){var b=window,c,e,f=!1,g=!1,h=a.browser.msie&&a.browser.version<7?!0:!1,i,j=h?'<iframe hideFocus="true" frameborder="0" src="about:blank" style="position:absolute;z-index:-1;width:100%;height:100%;top:0px;left:0px;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>':"",k=function(a){d=a||document;return d.compatMode==="CSS1Compat"?d.documentElement:d.body},l=function(){i||(i=9999);return++i},m=function(b){if(a.browser.msie)return b.event;var c=m.caller;while(c!=null){var d=c.arguments[0];if(d&&(d+"").indexOf("Event")>=0)return d;c=c.caller}return null},n=function(a){if("pageXOffset"in a)return{x:a.pageXOffset||0,y:a.pageYOffset||0};var b=k(a.document);return{x:b.scrollLeft||0,y:b.scrollTop||0}},o=function(a){var b=k(a);return{w:b.clientWidth||0,h:b.clientHeight||0}},p=function(b){var c=k(b);a(e).css({width:Math.max(c.scrollWidth,c.clientWidth||0)-1+"px",height:Math.max(c.scrollHeight,c.clientHeight||0)-1+"px"})},q=function(){var b=a("script"),c="",d=0,e=b.length;for(;d<e;d++)if(b[d].src.indexOf("lhgdialog.min.js")>=0||b[d].src.indexOf("lhgdialog.js")>=0){c=!document.querySelector?b[d].getAttribute("src",4):b[d].src;break}return c.substr(0,c.lastIndexOf("/")+1)};while(b.parent&&b.parent!=b){try{if(b.parent.document.domain!=document.domain)break}catch(r){break}b=b.parent}b.document.getElementsByTagName("frameset").length>0&&(b=window),c=b.document,a.fn.fixie6png=function(){var b=a("*",this),c,d;for(var e=0,f=b.length;e<f;e++)d=a(b[e]).css("backgroundImage"),d.indexOf(".png")!==-1&&(c=d.replace(/url\(|"|\)/g,""),b[e].style.backgroundImage="none",b[e].runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+c+"',sizingMethod='scale')")},a.fn.dialog=function(b){var c=!1;this[0]&&(c=new a.dialog(b,this[0]));return c},a.dialog=function(d,r){var s=this,t,u,v,w,x,y,z,A,B=b,C=c,D=s.opt=a.extend({title:"lhgdialog \u5F39\u51FA\u7A97\u53E3",cover:!1,titleBar:!0,btnBar:!0,xButton:!0,cancelBtn:!0,width:400,height:300,id:"lhgdgId",SetTopWindow:null,link:!1,html:null,page:null,parent:null,dgOnLoad:null,onXclick:null,onCancel:null,fixed:!1,top:"center",left:"center",drag:!0,resize:!0,autoSize:!1,rang:!1,iconTitle:!0,loadingText:"\u7A97\u53E3\u5185\u5BB9\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u7B49..."},d||{}),E=function(a){var b=a.style,c=k(C),d=parseInt(b.left)-c.scrollLeft,e=parseInt(b.top)-c.scrollTop;b.removeExpression("left"),b.removeExpression("top"),b.setExpression("left","this.ownerDocument.documentElement.scrollLeft"+d),b.setExpression("top","this.ownerDocument.documentElement.scrollTop + "+e)},F=function(){try{C.execCommand("BackgroundImageCache",!1,!0)}catch(b){}D.fixed&&h&&a("body",C).css("backgroundAttachment")!=="fixed"&&a("html",C).css({backgroundImage:"url(about:blank)",backgroundAttachment:"fixed"}),a("head",C).append('<link href="'+q()+'lhgdialog.css" rel="stylesheet" type="text/css"/>')},G=function(){var a,b;D.html?typeof D.html=="string"?a='<div id="lhgdg_inbox_'+D.id+'" class="lhgdg_inbox" style="display:none">'+D.html+"</div>":a='<div id="lhgdg_inbox_'+D.id+'" class="lhgdg_inbox" style="display:none"></div>':D.page&&(a='<iframe id="lhgfrm_'+D.id+'" frameborder="0" src="'+D.page+'" '+'scrolling="auto" style="display:none;width:100%;height:100%;"></iframe>'),b=['<div id="',D.id,'" class="lhgdialog" style="width:',D.width,"px;height:",D.height,'px;">','<table border="0" cellspacing="0" cellpadding="0" width="100%">',"<tr>",'<td class="lhgdg_leftTop"></td>','<td id="lhgdg_drag_',D.id,'" class="lhgdg_top">',D.titleBar?(D.iconTitle?'<div class="lhgdg_icon"></div>':"")+'<div class="lhgdg_title">'+D.title+"</div>"+(D.xButton?'<div class="lhgdg_Xdiv"><a class="lhgdg_xbtn" id="lhgdg_xbtn_'+D.id+'" href="###"></a></div>':""):"","</td>",'<td class="lhgdg_rightTop"></td>',"</tr>","<tr>",'<td class="lhgdg_left"></td>',"<td>",'<table border="0" cellspacing="0" cellpadding="0" width="100%">',"<tr>",'<td id="lhgdg_content_',D.id,'" style="background-color:#fff">',a,'<div id="lhgdg_load_',D.id,'" class="lhgdg_load"><span>',D.loadingText,"</span></div>","</td>","</tr>",D.btnBar?'<tr><td id="lhgdg_btnBar_'+D.id+'" class="lhgdg_btnBar"></td></tr>':"","</table>","</td>",'<td class="lhgdg_right"></td>',"</tr>","<tr>",'<td class="lhgdg_leftBottom"></td>','<td class="lhgdg_bottom"></td>','<td id="lhgdg_drop_',D.id,'" class="lhgdg_rightBottom"></td>',"</tr>","</table>",j,"</div>"].join("");return b},H=function(){e=a("#lhgdgCover",C)[0];if(!e){var b='<div id="lhgdgCover" style="position:absolute;top:0px;left:0px;background-color:#999;">'+j+"</div>";e=a(b,C).css("opacity",.5).appendTo(C.body)[0]}a(B).bind("resize",p),p(C),a(e).css({display:"",zIndex:l()})},I=function(b,c,d,e){var f=o(C),g=n(B),i=b.offsetWidth,j=b.offsetHeight,k,l,m,p,q,r,s,t;e?(m=h?g.x:0,p=h?f.w+g.x-i:f.w-i,q=h?(p+g.x-20)/2:(p-20)/2,r=h?g.y:0,s=h?f.h+g.y-j:f.h-j,t=h?(s+g.y-20)/2:(s-20)/2):(m=g.x,q=g.x+(f.w-i-20)/2,p=g.x+f.w-i,r=g.y,t=g.y+(f.h-j-20)/2,s=g.y+f.h-j);switch(d){case"center":k=q;break;case"left":k=m;break;case"right":k=p;break;default:e&&h&&(d=d+g.x),k=d}switch(c){case"center":l=t;break;case"top":l=r;break;case"bottom":l=s;break;default:e&&h&&(c=c+g.y),l=c}a(b).css({top:l+"px",left:k+"px"}),e&&h&&E(b)},K=function(b){s.topWin=B,s.topDoc=C,s.curWin=window,s.curDoc=document,a(b).bind("contextmenu",function(a){a.preventDefault()}).bind("mousedown",s.SetIndex),D.html&&D.html.nodeType&&a(u).append(D.html),A=[window],B!=window&&A.push(B),D.page&&(s.dgFrm=a("#lhgfrm_"+D.id,C)[0],D.link||(s.dgWin=s.dgFrm.contentWindow,s.dgFrm.lhgDG=s),a(s.dgFrm).bind("load",function(){if(!D.link){var b=a.browser.msie?s.dgWin.document:s.dgWin;a(b).bind("mousedown",s.SetIndex),A.push(s.dgWin),s.dgDoc=s.dgWin.document}this.style.display="block",t.style.display="none",D.autoSize&&M(),a.isFunction(D.dgOnLoad)&&D.dgOnLoad.call(s)})),D.xButton&&D.titleBar&&a(v).hover(function(){a(this).addClass("lhgdg_xbtnover")},function(){a(this).removeClass("lhgdg_xbtnover")}).bind("click",D.onXclick)},L=function(a){var b=w.offsetHeight,c=x.offsetHeight,d=D.btnBar?y.offsetHeight:0,e=parseInt(a.style.height,10)-b-c-d;t.style.lineHeight=e+"px",z.style.height=e+"px"},M=function(){var a=w.offsetHeight,b=x.offsetHeight,c=D.btnBar?y.offsetHeight:0,d=x.offsetWidth*2,e,f,g;D.html?(e=Math.max(u.scrollHeight,u.clientHeight||0),f=Math.max(u.scrollWidth,u.clientWidth||0)):D.page&&(g=k(s.dgDoc),e=Math.max(g.scrollHeight,g.clientHeight||0),f=Math.max(g.scrollWidth,g.clientWidth||0)),e=e+a+b+c,f=f+d,s.reDialogSize(f,e)},N=function(b){function m(d){for(var e=0,f=g.length;e<f;e++)a(g[e].document).unbind("mousemove",l),a(g[e].document).unbind("mouseup",m);c=null,b=null,D.fixed&&h&&E(s.dg),a.browser.msie&&s.dg.releaseCapture()}function l(a){var b={x:a.screenX,y:a.screenY};f={x:f.x+(b.x-c.x),y:f.y+(b.y-c.y)},c=b,D.rang&&(f.x<k.x&&(f.x=k.x),f.y<k.y&&(f.y=k.y),f.x>d&&(f.x=d),f.y>e&&(f.y=e)),s.dg.style.top=D.fixed&&!h?f.y-k.y+"px":f.y+"px",s.dg.style.left=D.fixed&&!h?f.x-k.x+"px":f.x+"px"}var c,d,e,f,g=A,j,k;a(b).bind("mousedown",function(b){if(b.target.id!=="lhgdg_xbtn_"+s.opt.id){j=o(C),k=n(B);var p=s.dg.offsetLeft,q=s.dg.offsetTop,r=s.dg.clientWidth,t=s.dg.clientHeight;f=D.fixed&&!h?{x:p+k.x,y:q+k.y}:{x:p,y:q},c={x:b.screenX,y:b.screenY},d=j.w+k.x-r,e=j.h+k.y-t,s.dg.style.zIndex=parseInt(i,10)+1;for(var u=0,v=g.length;u<v;u++)a(g[u].document).bind("mousemove",l),a(g[u].document).bind("mouseup",m);b.preventDefault(),a.browser.msie&&s.dg.setCapture()}})},O=function(b){function m(d){for(var e=0,f=g.length;e<f;e++)a(g[e].document).unbind("mousemove",l),a(g[e].document).unbind("mouseup",m);c=null,b=null,a.browser.msie&&s.dg.releaseCapture()}function l(a){var b={x:a.screenX,y:a.screenY};h={w:b.x-c.x,h:b.y-c.y},h.w<200&&(h.w=200),h.h<100&&(h.h=100),s.dg.style.top=D.fixed?f.y-k.y+"px":f.y+"px",s.dg.style.left=D.fixed?f.x-k.x+"px":f.x+"px",s.reDialogSize(h.w,h.h)}var c,d,e,f,g=A,h,j,k;a(b).bind("mousedown",function(b){e=s.dg.clientWidth,d=s.dg.clientHeight,h={w:e,h:d},j=o(C),k=n(B);var p=s.dg.offsetLeft,q=s.dg.offsetTop;f=D.fixed?{x:p+k.x,y:q+k.y}:{x:p,y:q},c={x:b.screenX-e,y:b.screenY-d},s.dg.style.zIndex=parseInt(i,10)+1;for(var r=0,t=g.length;r<t;r++)a(g[r].document).bind("mousemove",l),a(g[r].document).bind("mouseup",m);b.preventDefault(),a.browser.msie&&s.dg.setCapture()})},P=function(){s.dgFrm&&(D.link||a(s.dgFrm).unbind("load"),s.dgFrm.src="about:blank",s.dgFrm=null),A=[],a(s.dg).remove(),s.dg=null,t=u=v=w=x=y=z=null};D.SetTopWindow&&!g&&(B=D.SetTopWindow,C=B.document,g=!0,B!=b&&F()),f||(f=!0,F()),s.ShowDialog=function(){if(a("#"+D.id,C)[0])return s;D.cover&&H();var b=D.fixed&&!h?"fixed":"absolute",c=G();s.dg=a(c,C).css({position:b,zIndex:l()}).appendTo(C.body)[0],t=a("#lhgdg_load_"+D.id,C)[0],u=a("#lhgdg_inbox_"+D.id,C)[0],v=a("#lhgdg_xbtn_"+D.id,C)[0],w=a("#lhgdg_drag_"+D.id,C)[0],x=a("#lhgdg_drop_"+D.id,C)[0],y=a("#lhgdg_btnBar_"+D.id,C)[0],z=a("#lhgdg_content_"+D.id,C)[0],L(s.dg),I(s.dg,D.top,D.left,D.fixed),K(s.dg),D.drag&&N(w),D.resize&&O(x);if(h){var d=a(s.dg).css("ie6png")==="true"?!0:!1;d&&a(s.dg).fixie6png()}D.html&&a.isFunction(D.dgOnLoad)&&D.dgOnLoad.call(s),D.html&&(t.style.display="none",u.style.display="",D.autoSize&&M()),D.btnBar&&D.cancelBtn&&s.addBtn("dgcancelBtn","\u53D6\u6D88",D.onCancel)},s.reDialogSize=function(b,c){a(s.dg).css({width:b+"px",height:c+"px"}),L(s.dg)},s.addBtn=function(b,c,d){if(D.btnBar)if(a("#lhgdg_"+D.id+"_"+b,C)[0])a("#lhgdg_"+D.id+"_"+b,C).html(c).click(d);else{var e='<div class="lhgdg_button"><button id="lhgdg_'+D.id+"_"+b+'">'+c+"</button></div>";btn=a(e,C).bind("click",d)[0],a("#lhgdg_btnBar_"+D.id,C).append(btn)}},s.removeBtn=function(b){a("#lhgdg_"+D.id+"_"+b,C)[0]&&a("#lhgdg_"+D.id+"_"+b,C).remove()},s.SetIndex=function(){s.dg.style.zIndex=parseInt(i,10)+1,i=parseInt(s.dg.style.zIndex,10);var a=m(B);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},s.cancel=function(){P();if(e)if(D.parent&&D.parent.opt.cover){var a=D.parent.dg.style.zIndex;e.style.zIndex=parseInt(a,10)-1}else e.style.display="none";var b=m(B);b.preventDefault?b.preventDefault():b.returnValue=!1},s.cleanDialog=function(){s.dg&&P(),e&&(a(e).remove(),e=null)},D.onCancel=D.onCancel||s.cancel,D.onXclick=D.onXclick||s.cancel,r&&a(r).bind("click",s.ShowDialog),a(window).bind("unload",s.cleanDialog)},a(function(){var b=setTimeout(function(){(new a.dialog({id:"reLoadId",html:"lhgdialog",width:100,title:"reLoad",height:100,left:-9e3})).ShowDialog(),clearTimeout(b)},150)})})(jQuery);